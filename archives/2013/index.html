<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>归档：2013 | Peng's Blog</title>
  <meta name="author" content="Peng Feixiang">
  
  <meta name="description" content="Hello everyone">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Peng's Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Peng's Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  
</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Peng's Blog</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
<h2 class="archive-title">2013</h2>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-07-16T03:29:50.000Z"><a href="/2013/07/16/keepalived-rst/">7月 16 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/07/16/keepalived-rst/">keepalived RST</a></h1>
  

    </header>
    <div class="entry">
      
        <h2>keepalived RST报文</h2>
<h3>keepalived</h3>
<p>假定keepalived服务器是<code>192.168.1.1</code>，http服务器是<code>192.168.1.183</code>.</p>
<p>启动keepalived后，从<code>192.168.1.1</code>或<code>192.168.1.183</code>上抓包可以看到很多<code>192.168.1.1</code>到<code>192.168.1.183</code>的<code>[RST ACK]</code>报文，6秒一个。</p>
<blockquote>
<p><strong>16:09:08</strong>.981844 IP 192.168.1.1.34318 &gt; 192.168.1.183.http: Flags [S], seq 108636079, win 14600, options [mss 1460,sackOK,TS val 250265385 ecr 0,nop,wscale 7], length 0</p>
<p><strong>16:09:08</strong>.982003 IP 192.168.1.183.http &gt; 192.168.1.1.34318: Flags [S.], seq 2574714220, ack 108636080, win 14480, options [mss 1460,sackOK,TS val 1724897103 ecr 250265385,nop,wscale 7], length 0</p>
<p><strong>16:09:08</strong>.982020 IP 192.168.1.1.34318 &gt; 192.168.1.183.http: Flags [.], ack 1, win 115, options [nop,nop,TS val 250265385 ecr 1724897103], length 0</p>
<p><strong>16:09:08</strong>.982096 IP 192.168.1.1.34318 &gt; 192.168.1.183.http: <strong>Flags [R.]</strong>, seq 1, ack 1, win 115, options [nop,nop,TS val 250265385 ecr 1724897103], length 0</p>
<p><strong>16:09:14</strong>.982592 IP 192.168.1.1.34320 &gt; 192.168.1.183.http: Flags [S], seq 2384928787, win 14600, options [mss 1460,sackOK,TS val 250271386 ecr 0,nop,wscale 7], length 0</p>
<p><strong>16:09:14</strong>.982733 IP 192.168.1.183.http &gt; 192.168.1.1.34320: Flags [S.], seq 1294088960, ack 2384928788, win 14480, options [mss 1460,sackOK,TS val 1724903103 ecr 250271386,nop,wscale 7], length 0</p>
<p><strong>16:09:14</strong>.982750 IP 192.168.1.1.34320 &gt; 192.168.1.183.http: Flags [.], ack 1, win 115, options [nop,nop,TS val 250271386 ecr 1724903103], length 0</p>
<p><strong>16:09:14</strong>.982826 IP 192.168.1.1.34320 &gt; 192.168.1.183.http: <strong>Flags [R.]</strong>, seq 1, ack 1, win 115, options [nop,nop,TS val 250271386 ecr 1724903103], length 0</p>
</blockquote>
<p>这是keepalived的健康检查机制，192.168.1.1会定期（默认6秒）向192.168.1.183发送一个TCP连接来检测http是否正常，为了减少TCP连接带来的资源浪费，检测（TCP三次握手）完毕后会发送一个RST报文来断开这个连接，释放资源。</p>
<p>如果业务服务器不是http，有时会在业务服务器日志里还会看到类似<a href="http://nginx.2469901.n2.nabble.com/Keep-alive-connection-errors-in-my-logs-td3385507.html"><code>connection reset by peer</code></a>的日志。</p>
<h3>RST报文</h3>
<p>当服务器close一个连接时，若client端接着发数据。根据TCP协议的规定，会收到一个<code>RST</code>响应，进程对接收了RST的socket发送数据时，内核会发出一个<code>SIGPIPE</code>信号给进程。根据信号的默认处理规则SIGPIPE信号的默认执行动作是<strong>终止进程</strong>,所以client会<strong>退出</strong>。若不想client退出可以把SIGPIPE设为<code>SIG_IGN</code>，如: <code>signal(SIGPIPE,SIG_IGN);</code>，这时SIGPIPE交给了系统处理。参考(1)</p>
<h3>有序释放与异常释放</h3>
<p>终止一个连接的正常方式是一方发送FIN，这被称为有序释放（orderly release），因为在所有排队数据已发送之后才发送FIN。但也有可能发送一个复位报文段而不是FIN来中途释放一个连接，有时称这为异常释放（abortive release）。</p>
<p>异常终止一个连接对应用程序来说有两个优点：</p>
<ol>
<li>丢弃任何待发数据并立即发送复位报文段；</li>
<li>RST的接收方会区分另一端执行的是异常关闭还是正常关闭。应用程序使用的
API必须提供产生异常关闭而不是正常关闭的手段。参考(2)</li>
</ol>
<h3>用有序释放来代替异常释放</h3>
<p>根据TCP协议，主动发起关闭的一方，会进入TIME_WAIT状态，持续2*MSL(Max Segment Lifetime)，缺省为240秒（？ RFC建议120秒，berkeley 实现30秒）。</p>
<p><img src="http://tech.ccidnet.com/pub/attachment/2004/8/322252.png" alt=""></p>
<p>一般来说服务器执行被动关闭，服务器不会进入TIME_WAIT状态。在Keepalived Server+ Real Server中 Server中Keepalived Server充当客户端主动发起关闭。两种方式：（1）关闭的时候使用RST的方式
（2）对处于TIME_WAIT状态的TCP允许重用。当前Keepalived 就被设计成使用RST关闭。</p>
<p>如果使用有序释放代替RST报文，Keepalived + NAT方式中，所有从Keepalived Server 到 Real Server的IP包的 source address都是一样的(对内地址）。TCP连接建立和关闭，会在Keepalived Server上留下TIME_WAIT状态，根据TIME_WAIT黑名单规则，Keepalived Server在240秒内不能再使用此端口建立和Real Server的连接。这样对于一个Real server 假定6秒检查一次，则需要240/6=40个端口来独占使用。对于有60000端口的Keepalived Server来说，可以支撑1000+的Real Server。</p>
<p>至于“对处于TIME_WAIT状态的TCP允许重用”，这种做法不建议使用，无非是减少端口的使用。更好的做法是减小MSL。</p>
<h3>使用TCP的KeepAlive机制</h3>
<p>很多应用层协议都有HeartBeat机制，通常是客户端每隔一小段时间向服务器发送一个数据包，通知服务器自己仍然在线，并传输一些可能必要的数据。使用心跳包的典型协议是IM，比如QQ/MSN/飞信等协议。</p>
<p>TCP的KeepAlive 是更低层次的“心跳检测”机制，主要为探测长连接的存活状况。默认如果一个给定的连接在两小时内没有任何的动作，则服务器就向客户发一个探测报文段，客户主机必须处于以下4个状态之一：</p>
<blockquote>
<p>客户主机依然正常运行，并从服务器可达。客户的TCP响应正常，而服务器也知道对方是正常的，服务器在两小时后将保活定时器复位。</p>
<p>客户主机已经崩溃，并且关闭或者正在重新启动。在任何一种情况下，客户的TCP都没有响应。服务端将不能收到对探测的响应，并在75秒后超时。服务器总共发送10个这样的探测 ，每个间隔75秒。如果服务器没有收到一个响应，它就认为客户主机已经关闭并终止连接。</p>
<p>客户主机崩溃并已经重新启动。服务器将收到一个对其保活探测的响应，这个响应是一个复位，使得服务器终止这个连接。</p>
<p>客户机正常运行，但是服务器不可达，这种情况与第二种类似，TCP能发现的就是没有收到探查的响应。</p>
</blockquote>
<p>TCP的KeepAlive功能开启需要做一些配置。参考<a href="http://www.tldp.org/HOWTO/html_single/TCP-Keepalive-HOWTO/#codeneeding">这里</a>，包括了KeepAlive的介绍、相关内核参数、C编程接口、如何为现有应用（可以或者不可以修改源码的）启用KeepAlive机制。</p>
<h3>总结</h3>
<p>使用TCP的KeepAlive机制，对Keepalived的调整会很大，大量代码修改。个人倾向“ 用有序释放来代替异常释放”，释放过程虽然不如RST方式简单明了，但性能可以接受，代码相对来说好修改一些。</p>
<h3>扩展阅读</h3>
<p><a href="http://rdc.taobao.com/blog/cs/?p=1055">tcp连接closse时协议栈发出rst报文, 而不是fin</a></p>
<h3>参考来源</h3>
<p>(1)<a href="http://blog.chinaunix.net/uid-192452-id-3279122.html"><a href="http://blog.chinaunix.net/uid-192452-id-3279122.html">http://blog.chinaunix.net/uid-192452-id-3279122.html</a></a></p>
<p>(2)TCP/IP 详解卷一：协议 p187</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-07-11T13:56:17.000Z"><a href="/2013/07/11/learn-mapreduce/">7月 11 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/07/11/learn-mapreduce/">Learn MapReduce</a></h1>
  

    </header>
    <div class="entry">
      
        <h1>MapReduce: 分布式计算框架</h1>
<p><a href="http://en.wikipedia.org/wiki/MapReduce">维基百科</a>中对MapReduce这样描述——&quot;<strong>MapReduce is a programming model for processing large data sets with a parallel, distributed algorithm on a cluster</strong>.&quot;
MapReduce的名字由函数式编程中常用的map和reduce两个单词组成。2004年Google公司的Jeffrey Dean 和 Sanjay Ghemawat在论文<a href="http://research.google.com/archive/mapreduce.html">MapReduce: Simplified Data Processing on Large Clusters</a>首次提出了MapReduce的思想。</p>
<p>MapReduce被广泛地应用于日志分析、海量数据排序、在海量数据中查找特定模式等场景中。Apache下的Hadoop项目是根据Google论文所实现的一个MapReduce框架。</p>
<h3>MapReduce</h3>
<ul>
<li>优点：可在段时间内完成大量工作。</li>
<li>缺点：算法必须经过重写，需要对系统工程有一定的了解。</li>
<li>适用数据类型：数值型和标称型。</li>
</ul>
<h2>工作流程</h2>
<p>MapReduce 在大量节点组成的集群上运行。它的工作流程是：单个作业被分成很多小份，输入数据也被切片(split)分发到每个节点，各个节点只在本地数据上做运算，对应的运算代码称为mapper，这个过程被称为map阶段。每个mapper的输出通过某种方式组合（一般还会做排序）。排序后的结果再被分成小份分发到各个节点进行下一步的工作，对应的运算代码称为reducer，此过程被称为reduce阶段。reducer的输出就是程序的最终执行结果。</p>
<p><img src="/img/mapreduce.png" alt="image"></p>
<ul>
<li>主节点控制MapReduce的作业流程。</li>
<li>MapReduce的作业可以分为map任务和reduce任务。</li>
<li>map任务之间不做数据交流，reduce任务也一样。</li>
<li>map和reduce阶段中间，有一个sort或combine</li>
<li>数据被重复存放在不同的机器上，以防某个机器失效。</li>
<li>mapper和reducer传输的数据形式为key/value对。</li>
</ul>
<p>（论文学习待补充……）</p>
<h2>参考</h2>
<ul>
<li><a href="http://www.manning.com/pharrington/">Machine Learning in Action</a></li>
</ul>
<h2>拓展阅读</h2>
<ul>
<li><a href="http://www.pgsqldb.org:8079/mwiki/index.php/MapReduce:_%E4%B8%80%E4%B8%AA%E5%B7%A8%E5%A4%A7%E7%9A%84%E5%80%92%E9%80%80">MapReduce: 一个巨大的倒退</a></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-06-20T02:26:05.000Z"><a href="/2013/06/20/hello-world/">6月 20 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/06/20/hello-world/">Hello World</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Welcome to <a href="http://zespia.tw/hexo">Hexo</a>! This is your very first post. Check <a href="http://zespia.tw/hexo/docs">documentation</a> to learn how to use.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-05-06T02:59:00.000Z"><a href="/2013/05/06/draft-mccann-dmm-flatarch-00/">5月 6 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/05/06/draft-mccann-dmm-flatarch-00/">draft-mccann-dmm-flatarch-00</a></h1>
  

    </header>
    <div class="entry">
      
        <h1>Authentication and Mobility Management in a Flat Architecture</h1>
<h3><a href="http://tools.ietf.org/html/draft-mccann-dmm-flatarch-00">draft-mccann-dmm-flatarch-00</a></h3>
<p>从运营商角度看待移动性管理，包含部署、身份认证等，略之</p>
<hr>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-05-06T02:55:00.000Z"><a href="/2013/05/06/draft-ma-dmm-romip-00/">5月 6 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/05/06/draft-ma-dmm-romip-00/">draft-ma-dmm-romip-00</a></h1>
  

    </header>
    <div class="entry">
      
        <h1>A Route Optimization solution support for Distributed Mobility Management</h1>
<h3><a href="http://tools.ietf.org/id/draft-ma-dmm-romip-00.txt">draft-ma-dmm-romip-00</a></h3>
<p>The first elements that provide IP connectivity to a set of MNs are also the mobility managers for those MNs.</p>
<ul>
<li>移动节点不参与任何与移动相关的信令交互。移动锚和接入路由器以及AAA代表主机负责管理IP移动性。</li>
<li>The Home Address (HoA 切换前MAAR分配的地址) and Care-of address (CoA 切换后MAAR分配的地址).</li>
<li>移动节点可以直接向通信节点发送数据包而不需要通过家乡移动锚。</li>
</ul>
<hr>
<h2>1.  Introduction</h2>
<ol>
<li>MIPv6 和 PMIPv6的缺点</li>
<li>在论文“<a href="http://eprints.networks.imdea.org/13/1/giust_mmfn2011.pdf">一个基于网络的分布式移动管理的局部性移动解决方案</a>”中，作者表述了两种方法：一个是完全分布式的方法，另一个是部分分布式的方法。第一个方法的主要问题是，如何在第一次连接到网络的时候和随后的切换之间区分移动锚和接入路由器。</li>
<li>这篇文档描述了移动锚和接入路由器以及AAA协议代表主机对IP移动性的支持。这个解决方案能解决两方面的问题，它不仅使得移动实体能在第一次接入网络时和随后的切换之间进行区分，而且能减少家乡移动锚的重担。移动节点能直接向通信节点转发数据包。数据包的发送不需要通过家乡移动锚。 这篇文档时严格遵照这两方面进行展开。</li>
<li>所遵循的两个原则:移动节点的移动对通信节点来说是透明的；移动节点不参与任何与移动相关的信令交互。</li>
</ol>
<h2>2.  Terminology</h2>
<ul>
<li>MAAR (Mobility anchor and Access Router)</li>
<li>AAA (Authentication, Authorization and Accounting )</li>
<li>DBU/DBA (Distributed BU/BA)</li>
<li>sDBU/sDBA.  The MAAR attached by the MN currently to sends a sDBU message to the MAAR attached by MN before the MN&#39;s movement.  After that, the MAAR attached by MN currently receives a sDBA message including the address of CN&#39;s MAAR which the CN is currently attached to.  After that, the MAAR attached by the MN currently updates its internal binding list.</li>
<li>dDBU/dDBA.  The MAAR attached by the MN currently sends a dDBU message to the MAAR attached by CN for refreshing the internal binding list of the CN&#39;s MAAR which the CN is currently attached to. After receiving the dDBU message, the CN&#39;s MAAR replies a dDBA message to the MN&#39;s MAAR.</li>
</ul>
<h2>3.  Operation</h2>
<pre><code><figure class="highlight"><pre><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span> <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
<span class="comment">|The</span> <span class="comment">user</span> <span class="comment">A|</span>  <span class="comment">|The</span> <span class="comment">user</span> <span class="comment">B|</span> <span class="comment">|A_MAAR2|</span>  <span class="comment">|B_MAAR2|</span>   <span class="comment">|A_MAAR3|</span>     <span class="comment">|</span> <span class="comment">AAA</span> <span class="comment">|</span>
<span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span> <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
     <span class="comment">|</span>             <span class="comment">|</span>           <span class="comment">|</span>          <span class="comment">|</span>           <span class="comment">|</span>             <span class="comment">|</span>
     <span class="comment">|</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">1</span>.<span class="comment">RS(A_HoA1</span>,<span class="comment">B_HoA1)</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="comment">|</span>             <span class="comment">|</span>
     <span class="comment">|</span>             <span class="comment">|</span>           <span class="comment">|</span>          <span class="comment">|</span>           <span class="comment">|</span>-<span class="comment">2</span>.<span class="comment">request</span>-<span class="literal">-</span>&gt;<span class="comment">|</span>
     <span class="comment">|</span>             <span class="comment">|</span>           <span class="comment">|</span>          <span class="comment">|</span>           <span class="comment">|</span>&lt;<span class="literal">-</span><span class="comment">3</span>.<span class="comment">response</span>-<span class="comment">|</span>
     <span class="comment">|</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">4</span>.<span class="comment">RA(A_HoA3)</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">|</span>             <span class="comment">|</span>
     <span class="comment">|</span>             <span class="comment">|</span>           <span class="comment">|</span>          <span class="comment">|</span>           <span class="comment">|</span>             <span class="comment">|</span>
     <span class="comment">|</span>             <span class="comment">|</span>           <span class="comment">|</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">5</span>.<span class="comment">sDBU</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">|</span>             <span class="comment">|</span>
     <span class="comment">|</span>             <span class="comment">|</span>           <span class="comment">|</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">6</span>. <span class="comment">sDBA</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="comment">|</span>             <span class="comment">|</span>
     <span class="comment">|</span>             <span class="comment">|</span>           <span class="comment">|</span>          <span class="comment">|</span>&lt;<span class="literal">-</span><span class="comment">7</span>.<span class="comment">dDBU</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">|</span>             <span class="comment">|</span>
     <span class="comment">|</span>             <span class="comment">|</span>           <span class="comment">|</span>          <span class="comment">|</span>-<span class="literal">-</span><span class="comment">8</span>.<span class="comment">dDBA</span> <span class="literal">-</span>&gt;<span class="comment">|</span>             <span class="comment">|</span>
     <span class="comment">|</span>             <span class="comment">|</span>           <span class="comment">|</span>          <span class="comment">|</span>           <span class="comment">|</span>             <span class="comment">|</span>


                 <span class="comment">Figure</span> <span class="comment">1:Signaling</span> <span class="comment">of</span> <span class="comment">MN</span> <span class="comment">handover</span>



  <span class="comment">________</span>                          <span class="comment">________</span>
 <span class="comment">|The</span> <span class="comment">user|</span>                        <span class="comment">|The</span> <span class="comment">user|</span>
 <span class="comment">|</span>   <span class="comment">B</span>    <span class="comment">|</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">move</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="comment">|</span>   <span class="comment">B</span>    <span class="comment">|</span>
 <span class="comment">|________|</span>                        <span class="comment">|________|</span>
                                      <span class="comment">#</span>  <span class="comment">*</span>
                                      <span class="comment">#</span>  <span class="comment">*</span>
                                      <span class="comment">#</span>  <span class="comment">*</span>
  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>                       <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
  <span class="comment">|</span>       <span class="comment">|</span>                       <span class="comment">|</span>       <span class="comment">|</span>
  <span class="comment">|B_MAAR1|</span>                       <span class="comment">|B_MAAR2|</span>
  <span class="comment">|</span>       <span class="comment">|</span>                     <span class="comment">/</span> <span class="comment">|</span>       <span class="comment">|</span>
  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>                    <span class="comment">/</span>  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
                              <span class="comment">/</span>  <span class="comment">#</span>  <span class="comment">/|</span> <span class="comment">*</span> <span class="comment">|</span>
                             <span class="comment">/</span>  <span class="comment">#</span>  <span class="comment">/</span> <span class="comment">|</span> <span class="comment">*</span> <span class="comment">|</span>
                            <span class="comment">/</span>  <span class="comment">#</span>  <span class="comment">/</span>  <span class="comment">|</span> <span class="comment">*</span> <span class="comment">|</span>
                           <span class="comment">/</span>  <span class="comment">#</span>  <span class="comment">/</span>   <span class="comment">|</span> <span class="comment">*</span> <span class="comment">|</span>
                          <span class="comment">/</span>  <span class="comment">#</span>  <span class="comment">/</span>    <span class="comment">|</span> <span class="comment">*</span> <span class="comment">|</span>
                         <span class="comment">/</span>  <span class="comment">#</span>  <span class="comment">/</span>     <span class="comment">|</span> <span class="comment">*</span> <span class="comment">|</span>
<span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>        <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span> <span class="comment">#</span>  <span class="comment">/</span>    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
<span class="comment">|</span>       <span class="comment">|</span>        <span class="comment">|</span>       <span class="comment">|</span>   <span class="comment">/</span>     <span class="comment">|</span>       <span class="comment">|</span>
<span class="comment">|A_MAAR1|</span>        <span class="comment">|A_MAAR2|</span>  <span class="comment">/</span>      <span class="comment">|A_MAAR3|</span>
<span class="comment">|</span>       <span class="comment">|</span>        <span class="comment">|</span>       <span class="comment">|</span>         <span class="comment">|</span>       <span class="comment">|</span>
<span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>        <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>         <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
                    <span class="comment">#</span>                   <span class="comment">*</span>
                    <span class="comment">#</span>                   <span class="comment">*</span>
                    <span class="comment">#</span>                   <span class="comment">*</span>
 <span class="comment">________</span>         <span class="comment">________</span>             <span class="comment">________</span>
<span class="comment">|The</span> <span class="comment">user|</span>       <span class="comment">|The</span> <span class="comment">user|</span>           <span class="comment">|The</span> <span class="comment">user|</span>
<span class="comment">|</span>   <span class="comment">A</span>    <span class="comment">|</span>-<span class="comment">move</span>-&gt;<span class="comment">|</span>   <span class="comment">A</span>    <span class="comment">|</span>-<span class="literal">-</span><span class="literal">-</span><span class="comment">move</span>-<span class="literal">-</span><span class="literal">-</span>&gt;<span class="comment">|</span>   <span class="comment">A</span>    <span class="comment">|</span>
<span class="comment">|________|</span>       <span class="comment">|________|</span>           <span class="comment">|________|</span>


             <span class="comment">Figure</span> <span class="comment">2:The</span> <span class="comment">transmission</span> <span class="comment">of</span> <span class="comment">data</span> <span class="comment">packets
</pre></figure></code></pre>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-05-06T02:50:00.000Z"><a href="/2013/05/06/draft-luo-dmm-with-mip-and-pmip-00/">5月 6 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/05/06/draft-luo-dmm-with-mip-and-pmip-00/">draft-luo-dmm-with-mip-and-pmip-00</a></h1>
  

    </header>
    <div class="entry">
      
        <h1>Distributed Mobility Management Approach with Mobile IP and Proxy Mobile IP</h1>
<h3><a href="http://tools.ietf.org/html/draft-luo-dmm-with-mip-and-pmip-00">draft-luo-dmm-with-mip-and-pmip-00</a></h3>
<pre><code><figure class="highlight"><pre>本文提出了分布式移动管理体系结构的概念以及该结构的一些主要处理方法。
这些处理方法可以兼容现有的移动IP和代理移动IP协议。
</pre></figure></code></pre>
<hr>
<h2>Introduction</h2>
<p>集中式移动锚定有一些诸如单点故障、非最优路径路由等缺点。这些缺点在<a href="http://tools.ietf.org/html/draft-liu-mext-distributed-mobile-ip-00">I-D.liu-mext-distributed-mobile-ip</a>中讨论过了。</p>
<p>本文提出了分布式移动管理体系结构的概念以及该结构的一些主要处理方法。这些处理方法可以兼容现有的移动IP和代理移动IP协议。</p>
<p>本文只是一个初稿，并不为了解决<a href="http://tools.ietf.org/html/draft-liu-mext-distributed-mobile-ip-00">I-D.liu-mext-distributed-mobile-ip</a>中所提出的所有问题。</p>
<h2>Terminology</h2>
<p>移动路由(MR)，这是一个逻辑功能，用于拦截从移动节点和HoA发送/接收的数据包并转发数据包，根据位置信息执行分布式路由选择。</p>
<p>主地址分配(HAA)，这是一个逻辑功能，用于向一个移动节点分配主网络前缀或主地址。</p>
<p>位置管理(LM)，这是一个逻辑功能，用于管理并跟踪移动节点位置信息，其中包括MN的HoA与MN路由地址(或另一网络元素，它知道如何对MN的数据包进行转发)的映射。</p>
<h2>Solution Overview</h2>
<p>本方案将集中式锚点分解为下列逻辑功能，来允许使用更灵活的设计来实现DMM：</p>
<ul>
<li><p>主地址分配功能 </p>
</li>
<li><p>移动路由功能</p>
</li>
<li><p>位置管理功能</p>
</li>
</ul>
<pre><code><figure class="highlight"><pre>            <span class="comment">One</span> <span class="comment">Administrative</span> <span class="comment">Domain</span>

    <span class="comment">(</span>     <span class="comment">LM1/HAA1</span>    <span class="comment">)(</span>  <span class="comment">LM2/HAA2</span> <span class="comment">)(</span>   <span class="comment">LM3</span>   <span class="comment">HAA3</span>  <span class="comment">)</span>
    <span class="comment">(</span>                 <span class="comment">)(</span>           <span class="comment">)(</span>               <span class="comment">)</span>
    <span class="comment">(</span>                 <span class="comment">)(</span>           <span class="comment">)(</span>               <span class="comment">)</span>
    <span class="comment">(</span>  <span class="comment">MR11</span>     <span class="comment">MR12</span>  <span class="comment">)(</span>     <span class="comment">MR2</span>   <span class="comment">)(</span> <span class="comment">MR31</span>    <span class="comment">MR32</span>  <span class="comment">)</span>
        <span class="literal">+</span>                               <span class="literal">+</span>
        <span class="comment">|</span>     <span class="comment">Local</span>        <span class="comment">Local</span>        <span class="comment">|</span>     <span class="comment">Local</span>
        <span class="comment">|</span>    <span class="comment">Network1</span>     <span class="comment">Network2</span>      <span class="comment">|</span>    <span class="comment">Network3</span>
        <span class="literal">+</span>                               <span class="literal">+</span>
       <span class="comment">MN1</span>                             <span class="comment">MN2</span>

       <span class="comment">Figure</span> <span class="comment">1</span>.  <span class="comment">An</span> <span class="comment">example</span> <span class="comment">of</span> <span class="comment">DMM</span> <span class="comment">deployment
</pre></figure></code></pre>
<p>本文中假设所有本地网络均属于同一个管理域。</p>
<p>MN最初连接的本地网络被称为它的Home Local Network。HAA功能是负责移动节点的IP地址\分配（例如HoA\HNP）。在移动过程中，移动节点可以离开它的Home Local Network进入另一个本地网络——Visited Local Network。</p>
<pre><code><figure class="highlight"><pre><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
<span class="comment">|</span>  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>         <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>    <span class="comment">|</span>  <span class="comment">|</span>        <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>       <span class="comment">|</span>
<span class="comment">|</span>  <span class="comment">|</span>   <span class="comment">HAA</span>   <span class="comment">|</span>         <span class="comment">|</span>   <span class="comment">LM</span>    <span class="literal">+</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="literal">+</span>   <span class="comment">LM</span>    <span class="comment">|</span>       <span class="comment">|</span>
<span class="comment">|</span>  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>         <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>    <span class="comment">|</span>  <span class="comment">|</span>        <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>       <span class="comment">|</span>
<span class="comment">|</span>      <span class="comment">;</span>                   <span class="comment">/|\</span>        <span class="comment">|</span>  <span class="comment">|</span>            <span class="comment">/|\</span>           <span class="comment">|</span>
<span class="comment">|</span>     <span class="comment">/|\</span>                   <span class="comment">|</span>         <span class="comment">|</span>  <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>
<span class="comment">|</span>      <span class="comment">|</span>                   <span class="comment">\|/</span>        <span class="comment">|</span>  <span class="comment">|</span>            <span class="comment">\|/</span>           <span class="comment">|</span>
<span class="comment">|</span>      <span class="comment">|</span>               <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>    <span class="comment">|</span>  <span class="comment">|</span>        <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>       <span class="comment">|</span>
<span class="comment">|</span>      <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt; <span class="comment">|</span>   <span class="comment">MR</span>    <span class="literal">+</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="literal">+</span>   <span class="comment">MR</span>    <span class="comment">|</span>       <span class="comment">|</span>
<span class="comment">|</span>                      <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>    <span class="comment">|</span>  <span class="comment">|</span>        <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>       <span class="comment">|</span>
<span class="comment">|</span>                        <span class="comment">/|\</span> <span class="comment">/|\</span>      <span class="comment">|</span>  <span class="comment">|</span>          <span class="comment">/|\</span> <span class="comment">/|\</span>         <span class="comment">|</span>
<span class="comment">|</span>                         <span class="comment">|</span>   <span class="comment">|</span>       <span class="comment">|</span>  <span class="comment">|</span>           <span class="comment">|</span>   <span class="comment">|</span>          <span class="comment">|</span>
<span class="comment">|</span>                         <span class="comment">|___|</span>       <span class="comment">|</span>  <span class="comment">|</span>           <span class="comment">|___|</span>          <span class="comment">|</span>
<span class="comment">|</span>                                     <span class="comment">|</span>  <span class="comment">|</span>                          <span class="comment">|</span>
<span class="comment">|</span> <span class="comment">Home</span> <span class="comment">Local</span> <span class="comment">Network</span>                  <span class="comment">|</span>  <span class="comment">|</span> <span class="comment">Visited</span> <span class="comment">Local</span> <span class="comment">Network</span>    <span class="comment">|</span>
<span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>

 <span class="comment">Figure</span> <span class="comment">2</span>.  <span class="comment">Architecture
</pre></figure></code></pre>
<p>HAA、LM和MR之间需要接口，它们被描述如下：</p>
<pre><code><figure class="highlight"><pre>   <span class="transposed_variable">a.</span>  HAA和MR之间的接口支持当在MN依附MR时，IP前缀或地址的分配。

   <span class="transposed_variable">b.</span>  LM和MR之间的接口支持MN路由位置管理，以及为MN设置最优路由。

   <span class="transposed_variable">c.</span>  MR和MR之间的接口支持在控制平面MN从原MR（pMR）切换到新的MR（nMR），并支持在数据平面以分布式的方式分发MN与CN间的流量
</pre></figure></code></pre>
<p>一个管理域可能存在大量的移动节点，LM可能需要保存大量的信息，LM可以以分布式数据库的形式来部署。</p>
<h2>Overview of the Distributed Mobility Management Approaches</h2>
<h4>Initial Attachment</h4>
<h4>Dynamic Mobility Management</h4>
<ol>
<li>pMR和nMR的HoA\HNP对于移动节点是可用</li>
<li>nMR下新发起的会话，优选使用新的HoA\HNP作为源IP</li>
<li>切换前发起的旧会话仍然可以使用旧的HoA\HNP作为源IP。</li>
</ol>
<p>上述策略基于以下前提：</p>
<ol>
<li><strong>移动节点应该可以管理多个HoAs\HNP</strong>。</li>
<li><strong>MN可以在MN上的应用请求IP地址绑定时决定返回哪一个HoA</strong>。</li>
</ol>
<h4>Distributed Routing</h4>
<pre><code><figure class="highlight"><pre><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>      <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
<span class="comment">|</span> <span class="comment">MN2</span> <span class="comment">|</span>      <span class="comment">|</span>  <span class="comment">MR31</span> <span class="comment">|</span>     <span class="comment">|</span>  <span class="comment">LM</span>   <span class="comment">|</span>    <span class="comment">|</span>  <span class="comment">MR11</span>  <span class="comment">|</span>     <span class="comment">|</span> <span class="comment">MN1</span> <span class="comment">|</span>
<span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>      <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
   <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>             <span class="comment">|</span>             <span class="comment">|</span>
   <span class="comment">|1</span>.<span class="comment">IP</span> <span class="comment">Traffic</span> <span class="comment">|</span>            <span class="comment">|</span>             <span class="comment">|</span>             <span class="comment">|</span>
   <span class="comment">|===========</span>&gt; <span class="comment">|</span> <span class="comment">2</span>. <span class="comment">Query</span>   <span class="comment">|</span>             <span class="comment">|</span>             <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt; <span class="comment">|</span>             <span class="comment">|</span>             <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span> <span class="comment">3</span>. <span class="comment">Rsp</span>     <span class="comment">|</span>             <span class="comment">|</span>             <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">|</span>             <span class="comment">|</span>             <span class="comment">|</span>
   <span class="comment">|</span>   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="comment">|</span>             <span class="comment">|</span>             <span class="comment">|</span>
   <span class="comment">|</span>   <span class="comment">|</span> <span class="comment">4</span>.<span class="comment">Record</span> <span class="comment">Location|</span>   <span class="comment">|</span>             <span class="comment">|</span>             <span class="comment">|</span>
   <span class="comment">|</span>   <span class="comment">|</span>   <span class="comment">of</span> <span class="comment">MN1</span> <span class="comment">Locally</span> <span class="comment">|</span>   <span class="comment">|</span>             <span class="comment">|</span>             <span class="comment">|</span>
   <span class="comment">|</span>   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="comment">|</span>             <span class="comment">|</span>             <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>  <span class="comment">5</span>. <span class="comment">Distributed</span> <span class="comment">Routing</span>  <span class="comment">|</span>             <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|========================</span>&gt; <span class="comment">|</span>             <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>             <span class="comment">|6</span>.<span class="comment">IP</span> <span class="comment">Traffic</span> <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>             <span class="comment">|===========</span>&gt; <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>             <span class="comment">|</span>             <span class="comment">|</span>

    <span class="comment">Figure</span> <span class="comment">3</span>.  <span class="comment">Optimized</span> <span class="comment">routing</span> <span class="comment">based</span> <span class="comment">on</span> <span class="comment">location</span> <span class="comment">query</span>



<span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>      <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
<span class="comment">|</span> <span class="comment">MN2</span> <span class="comment">|</span>      <span class="comment">|</span>  <span class="comment">MR31</span> <span class="comment">|</span>     <span class="comment">|</span>  <span class="comment">LM1</span>  <span class="comment">|</span>    <span class="comment">|</span>  <span class="comment">MR12</span>  <span class="comment">|</span>   <span class="comment">|</span>  <span class="comment">MR11</span>  <span class="comment">|</span>   <span class="comment">|</span> <span class="comment">MN1</span> <span class="comment">|</span>
<span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>      <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
   <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|1</span>.<span class="comment">IP</span> <span class="comment">Traffic</span> <span class="comment">|</span>            <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|============</span>&gt;<span class="comment">|</span>            <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|</span>    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span> <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|</span>    <span class="comment">|2</span>.<span class="comment">Don't</span> <span class="comment">have</span> <span class="comment">MN1's</span> <span class="comment">|</span> <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|</span>    <span class="comment">|</span>  <span class="comment">Routing</span> <span class="comment">Location</span> <span class="comment">|</span> <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|</span>    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span> <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span> <span class="comment">3</span>. <span class="comment">Regular</span> <span class="comment">IPv6</span> <span class="comment">Routing</span>  <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|========================</span>&gt; <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>   <span class="comment">4</span>. <span class="comment">Query</span>  <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>   <span class="comment">5</span>. <span class="comment">Rsp</span>    <span class="comment">|</span> <span class="comment">6</span>. <span class="comment">Distributed</span>         <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="comment">|</span>    <span class="comment">Routing</span>             <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>     <span class="comment">8</span>. <span class="comment">Redirect</span>          <span class="comment">|===========</span>&gt;<span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">|</span>            <span class="comment">7</span>.<span class="comment">IP</span> <span class="comment">Traffic|</span>
   <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|==========</span>&gt;<span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>         <span class="comment">9</span>. <span class="comment">Distributed</span> <span class="comment">Routing</span>        <span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|======================================</span>&gt;<span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>             <span class="comment">|</span>           <span class="comment">10</span>.<span class="comment">IP</span> <span class="comment">Traffic|</span>
   <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|==========</span>&gt;<span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>
   <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>             <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>

       <span class="comment">Figure</span> <span class="comment">4</span>.  <span class="comment">Another</span> <span class="comment">approach</span> <span class="comment">for</span> <span class="comment">optimized</span> <span class="comment">routing</span>


<span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
<span class="comment">|MN1|</span>     <span class="comment">|</span>  <span class="comment">MR11</span>  <span class="comment">|</span>   <span class="comment">|</span>   <span class="comment">MR2</span>  <span class="comment">|</span>   <span class="comment">|</span>  <span class="comment">LM1</span>  <span class="comment">|</span>  <span class="comment">|</span>  <span class="comment">MR31</span>  <span class="comment">|</span>     <span class="comment">|MN2|</span>
<span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
  <span class="comment">|</span>            <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">1</span>. <span class="comment">Ongoing</span> <span class="comment">traffic</span>       <span class="comment">|</span>           <span class="comment">|</span>
  <span class="comment">|</span>&lt;<span class="comment">==========</span>&gt;<span class="comment">|</span>&lt;<span class="comment">==================================</span>&gt;<span class="comment">|</span>&lt;<span class="comment">========</span>&gt; <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>  <span class="comment">2</span>. <span class="comment">Context|</span>           <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>  <span class="comment">Transfer</span>  <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span> <span class="comment">3</span>. <span class="comment">IP</span>     <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span> <span class="comment">Traffic</span>   <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>            <span class="comment">4</span>. <span class="comment">Distributed</span> <span class="comment">Routing</span>  <span class="comment">|</span>&lt;<span class="comment">=========</span> <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>&lt;<span class="comment">===================================|</span>           <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|5</span>. <span class="comment">Transfer</span> <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|==========</span>&gt; <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>
  <span class="comment">|</span>    <span class="comment">6</span>. <span class="comment">IP</span> <span class="comment">Traffic</span>        <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>
  <span class="comment">|</span>&lt;<span class="comment">=======================</span> <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>            <span class="comment">|</span> <span class="comment">7</span>. <span class="comment">Redirect</span>           <span class="comment">|</span>           <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt; <span class="comment">|</span>           <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span> <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>    <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span> <span class="comment">|</span> <span class="comment">8</span>. <span class="comment">Update</span>      <span class="comment">|</span>    <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span> <span class="comment">|</span> <span class="comment">Location</span> <span class="comment">of</span> <span class="comment">MN1|</span>    <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span> <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>    <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>  <span class="comment">9</span>. <span class="comment">IP</span>    <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>            <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>  <span class="comment">Traffic</span>  <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>            <span class="comment">|10</span>. <span class="comment">Distributed</span> <span class="comment">Routing|</span>&lt;<span class="comment">==========|</span>
  <span class="comment">|</span>    <span class="comment">11</span>. <span class="comment">IP</span> <span class="comment">Traffic</span>       <span class="comment">|</span>&lt;<span class="comment">======================|</span>           <span class="comment">|</span>
  <span class="comment">|</span>&lt;<span class="comment">========================|</span>                       <span class="comment">|</span>           <span class="comment">|</span>
  <span class="comment">|</span>            <span class="comment">|</span>            <span class="comment">|</span>                       <span class="comment">|</span>           <span class="comment">|</span>

        <span class="comment">Figure</span> <span class="comment">5</span>.  <span class="comment">Handover</span> <span class="comment">with</span> <span class="comment">Active</span> <span class="comment">Session
</pre></figure></code></pre>
<h2>Considerations of the Optimized Routing</h2>
<p>CN被假定为移动节点。这意味着CN必须连接到一个确定的MR，而且这个MR必须跟踪CN的位置并解析从CN到MN的所有数据包。但是，当CN为固定节点时，可能就没有这样为CN服务的MR了。</p>
<p>现实环境中，大多数的固定节点（CN）都以一种集中的方式被部署，例如CDN/IDC/Web服务器等。这些固定节点一般是由同一对接入路由器汇聚，即使那些固定的节点的接入运营商的IP承载网拓扑可能是非常复杂的。 图6是一个示例。</p>
<pre><code><figure class="highlight"><pre>   <span class="comment">__________</span>
  <span class="comment">/</span>    <span class="comment">CN</span>     <span class="comment">\</span>            <span class="string">,</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>
<span class="comment">((CDN\IDC\Web</span> <span class="comment">)</span>-<span class="literal">-</span><span class="literal">-</span><span class="comment">Access</span> <span class="comment">Router</span>     <span class="comment">`</span>.
<span class="comment">(</span>   <span class="comment">Server)</span>   <span class="comment">)</span>    <span class="string">,</span><span class="literal">-</span><span class="literal">-</span><span class="comment">'</span>               <span class="comment">`'</span>
 <span class="comment">\___________/</span>     <span class="comment">\</span>                 <span class="comment">_</span> <span class="literal">-</span><span class="comment">'</span>
                    <span class="comment">'</span>-<span class="literal">-</span>  <span class="comment">MR</span>  <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">''</span>
                          <span class="comment">|</span>
                          <span class="comment">|</span>
                         <span class="comment">MN1</span>

 <span class="comment">Figure</span> <span class="comment">6</span>.  <span class="comment">CNs</span> <span class="comment">are</span> <span class="comment">fixed</span> <span class="comment">nodes
</pre></figure></code></pre>
<p>对于在图6中描述的场景，直接的解决方案是利用所谓的汇聚接入路由器或网关路由器（即在上图标出的接入路由器）实现MR功能。</p>
<p>另一种替代方法是使用<a href="http://tools.ietf.org/html/draft-chan-dmm-framework-gap-analysis-06">I-D.chan-dmm-framework-gap-analysis</a>和<a href="http://tools.ietf.org/html/draft-wakikawa-mext-global-haha-spec-02">I-D.wakikawa-mext-global-haha-spec</a>中所描述的anycast机制。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-05-06T02:50:00.000Z"><a href="/2013/05/06/draft-ma-dmm-armip-00/">5月 6 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/05/06/draft-ma-dmm-armip-00/">draft-ma-dmm-armip-00</a></h1>
  

    </header>
    <div class="entry">
      
        <h1>An AR-level solution support for Distributed Mobility Management</h1>
<h3><a href="https://tools.ietf.org/html/draft-ma-dmm-armip-00">draft-ma-dmm-armip-00</a></h3>
<hr>
<h2>1.  Introduction</h2>
<p>这篇文档以主机的方式描述了MAAR和AAA对IP移动性管理的支持。这能够解决移动实体对第一次连接到网络和随后切换之间的区分这一问题。本文件严格遵守两个原则。第一个是，MN（移动节点）的移动对CN（核心网络）是透明的。另一个是MN（移动节点）不参与任何和移动性相关的信令传输。</p>
<h2>2.  Terminology</h2>
<ul>
<li>MAAR(Mobility anchor and Access Router)</li>
<li>AMAAR (Accessing MAAR).指当前MN连接到的MAAR.每个ALMN必须为当前注册过的移动节点建立并维护两个绑定的列表。一个是内部绑定列表，另一个是外部绑定列表。每一个AMAAR都为新用户配置IPv6地址。因此AMAAR代表每一个移动节点执行移动性管理。每个AMAAR负责检测移动节点的运动和接入链路，并且用于绑定注册的初始化。</li>
<li>FMAAR (Forwarding MAAR).指被MN以前访问过的MAAR，仍有active flow。MN可以具有一个或多个FMAAR。</li>
<li>AAA (Authentication, Authorization and Accounting). AAA服务器记录用户的静态和动态信息，而动态信息包括该MN当前注册的MAAR的地址信息。</li>
<li><p>DBU/DBA (Distributed BU/BA).一个MAAR发送DBU/DBA消息给另一个MAAR来建立相应的绑定列表。在本文中，有两种DBU/DBA信息。一个是pDBU/pDBA消息，另一个是的fDBU/ fDBA消息。</p>
</li>
<li><p>pDBU/pDBA.pDBU消息是通过移动节点的AMAAR发送给PMAAR,目的是在移动节点的AMAAR和PMAAR之间建立绑定。这个消息包括了AMAAR的地址。收到pDBU消息后，PMAAR给AMAAR发送一个pDBA消息进行答复，此消息包括FMAAR的地址和由FMAAR分配的MN的地址。fDBU/fDBA.fDBA消息由移动节点的AMAAR发送给FMAAR（不包括PMAAR），目的是在移动节点的AMAAR和FMAAR(不包括PMAAR)之间建立绑定。这个消息包括AMAAR的地址。收到fDBU消息后，FMAAR会给AMAAR发送一个fDBA消息进行答复。</p>
</li>
</ul>
<h2>3.  MAAR Operation</h2>
<h4>关键操作</h4>
<ul>
<li>AMAAR MUST send diameter request message to the AAA after detecting the MN&#39;s movement to the access link.AAA能够区分MN是第一次连接，还是切换后的连接。</li>
<li>MAAR 维护两个绑定列表，内部绑定列表和外部的绑定列表。内部列表里绑定FMAAR分配的MN地址和MN的FMAAR的地址；内部绑定列表里绑定AMAAR分配的MN的地址和FMAAR分配的此MN的地址。</li>
<li>每个FMAAR必须为每个之前注册过的MN维护一个绑定列表。这张列表存储了由FMAAR分配的MN的地址的绑定和此MN的AMAAR的地址。</li>
<li>AMAAR和PMAAR建立双向隧道转发属于MN的所有数据流量。（地址绑定——AMAAR从AAA那获取PMAAR地址，AMAAR向PMAAR发送pDBU）</li>
</ul>
<h2>4.  Description of the solution</h2>
<p>分布式移动管理方法的目的是克服传统的集中式移动管理的限制，通过使移动锚点更接近MN.遵循这一理念，我们建议，中央锚移动到网络的边缘，被部署在所述移动节点的接入路由器。也就是说，提供MN IP连通性的第一个元素也就是这些MN的移动管理者。</p>
<pre><code><figure class="highlight"><pre>    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>       <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>          <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
    <span class="comment">|</span>  <span class="comment">MN</span> <span class="comment">|</span>     <span class="comment">|</span> <span class="comment">MAAR1|</span>   <span class="comment">|</span> <span class="comment">MAAR2|</span>       <span class="comment">|</span> <span class="comment">MAAR3|</span>          <span class="comment">|</span> <span class="comment">AAA|</span>
    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>       <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>          <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
       <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>             <span class="comment">|</span>                 <span class="comment">|</span>
       <span class="comment">|</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">1</span>.<span class="comment">RS(HoA1</span>,<span class="comment">HoA2)</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="comment">|</span>                 <span class="comment">|</span>
       <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>             <span class="comment">|</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">2</span>.<span class="comment">request</span>-<span class="literal">-</span><span class="literal">-</span>&gt;<span class="comment">|</span>
       <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>             <span class="comment">|</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">3</span>.<span class="comment">response</span>-<span class="literal">-</span><span class="literal">-</span><span class="comment">|</span>
       <span class="comment">|</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">4</span>.<span class="comment">RA(HoA3)</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span> <span class="comment">|</span>                 <span class="comment">|</span>
       <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>             <span class="comment">|</span>                 <span class="comment">|</span>
       <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="comment">5</span>.<span class="comment">pDBU</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">|</span>                 <span class="comment">|</span>
       <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>-<span class="literal">-</span><span class="comment">6</span>. <span class="comment">pDBA</span> <span class="literal">-</span><span class="literal">-</span>&gt;<span class="comment">|</span>                 <span class="comment">|</span>
       <span class="comment">|</span>           <span class="comment">|</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">7</span>.<span class="comment">fDBU</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">|</span>                 <span class="comment">|</span>
       <span class="comment">|</span>           <span class="comment">|</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">8</span>.<span class="comment">fDBA</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt;<span class="comment">|</span>                 <span class="comment">|</span>
       <span class="comment">|</span>           <span class="comment">|</span>                         <span class="comment">|</span>                 <span class="comment">|</span>



                 <span class="comment">Figure</span> <span class="comment">1:Signaling</span> <span class="comment">of</span> <span class="comment">MN</span> <span class="comment">handover
</pre></figure></code></pre>
<ol>
<li>MN从MAAR1，MAAR2 切换到MAAR3，MN发送一个包含HoA1和HoA2的消息给MAAR3。</li>
<li>MAAR3发送diameter请求信息给AAA</li>
<li>AAA有MAAR2的地址信息。AAA发送包含MAAR2的diameter答复信息，然后AAA更新包括MAAR3地址信息在内的MN的动态信息。</li>
<li>MAAR3分配给MN另一个IPv6地址（HoA3）。同时，MAAR3建立并维护存储HoA1和HoA3，HoA2和HoA3绑定的外部绑定列表。</li>
<li>与此同时，MAAR3发送包含MAAR3地址的pDBU信息给MAAR2.</li>
<li>现在MAAR2有两个绑定列表。一个是内部绑定列表，另一个是外部绑定列表。第一个存储MAAR1的地址和HoA1。第二个存储HoA1和HoA1的绑定。在收到pDBU信息之后，MAAR2发送包括内部绑定列表、HoA2和MAAR2的地址在内的pDBA信息。之后，MAAR2用一个存储了HoA2和MAAR3地址的绑定列表替换这两个绑定列表。</li>
<li>在收到pDBA信息后，MAAR3建立并维护这个存储了HoA1和MAAR1的地址绑定、HoA2和MAAR2的地址绑定的内部绑定列表。MAAR3发送包含MAAR3地址的fDBU信息给MAAR1。</li>
<li>在收到fDBU信息后，MAAR1回复一个fDBA信息，并且更新之前存储HoA1和MAAR2的地址的绑定列表。这个列表现在存储了HoA1和MAAR3的地址。</li>
</ol>
<h2>5.  Forwarding Considerations</h2>
<p>在收到有MN发送的数据包后，AMAAR将会检查数据包的源地址。如果这个地址是由AMAAR分配的，AMAAR就会根据包的目的地址将包转发给CN。如果地址不是由AMAAR分配的，AMAAR就会根据源地址搜索内部绑定列表，然后找到相应的FMAAR的地址。然后，AMAAR封装这些包到相应的FMAAR。</p>
<pre><code><figure class="highlight"><pre>    <span class="comment">_______</span>         <span class="comment">_______</span>          <span class="comment">_______</span>
   <span class="comment">|</span>       <span class="comment">|</span>       <span class="comment">|</span>       <span class="comment">|</span>        <span class="comment">|</span>       <span class="comment">|</span>
   <span class="comment">|</span>  <span class="comment">CN1</span>  <span class="comment">|</span>       <span class="comment">|</span>  <span class="comment">CN2</span>  <span class="comment">|</span>        <span class="comment">|</span>  <span class="comment">CN3</span>  <span class="comment">|</span>
   <span class="comment">|_______|</span>       <span class="comment">|_______|</span>        <span class="comment">|_______|</span>
       <span class="comment">'</span>               <span class="comment">*</span>  <span class="comment">Flow#2</span>         <span class="string">.</span>
<span class="comment">Flow#1</span> <span class="comment">'</span>               <span class="comment">*</span>                 <span class="comment">|</span> <span class="comment">Flow#3</span>
       <span class="comment">'</span>  <span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span> <span class="comment">'''''''*''''''''''''</span>.<span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span> <span class="string">.</span>
     <span class="string">.</span><span class="string">.</span><span class="comment">'''</span>             <span class="comment">*</span>                 <span class="comment">'''</span>.<span class="string">.</span>
   <span class="string">.</span><span class="comment">'</span>  <span class="comment">'</span>            <span class="comment">IP</span> <span class="comment">*</span> <span class="comment">network</span>         <span class="string">.</span>   <span class="comment">'</span>.
   <span class="comment">:</span>   <span class="comment">'</span>               <span class="comment">*</span>                 <span class="comment">|</span>    <span class="comment">:</span>
    <span class="comment">'</span>.<span class="string">.</span><span class="comment">'</span>           <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>             <span class="string">.</span> <span class="string">.</span><span class="string">.</span><span class="comment">'</span>
       <span class="comment">'''</span>.<span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span>  <span class="comment">|</span>       <span class="comment">|</span>    <span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="comment">'''</span>
       <span class="comment">'</span>           <span class="comment">|</span> <span class="comment">MAAR2</span> <span class="comment">|\</span>            <span class="string">.</span>
       <span class="comment">'</span>           <span class="comment">|</span>       <span class="comment">|</span> <span class="comment">\</span>           <span class="comment">|</span>
       <span class="comment">'</span>           <span class="comment">|</span>       <span class="comment">|*</span> <span class="comment">\</span>          <span class="string">.</span>
       <span class="comment">'</span>           <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="comment">\*</span> <span class="comment">\</span>         <span class="comment">|</span>
 <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>                   <span class="comment">\*</span> <span class="comment">\</span> <span class="literal">+</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
 <span class="comment">|</span>       <span class="comment">|</span>                    <span class="comment">\*</span>  <span class="comment">|</span>       <span class="comment">|</span>
 <span class="comment">|</span> <span class="comment">MAAR1</span> <span class="comment">|</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">|</span> <span class="comment">MAAR3</span> <span class="comment">|</span>
 <span class="comment">|</span>       <span class="comment">|''''''''''''''''''''''''|</span>       <span class="comment">|</span>
 <span class="comment">|</span>       <span class="comment">|</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">|</span>       <span class="comment">|</span>
 <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>                        <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
                                     <span class="comment">'</span> <span class="comment">*</span> <span class="comment">|</span>
                             <span class="comment">Flow#1</span>  <span class="comment">'</span> <span class="comment">*</span> <span class="string">.</span> <span class="comment">Flow#3</span>
                                     <span class="comment">'</span> <span class="comment">*</span> <span class="comment">|</span>
   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>                   <span class="comment">Flow#2</span> <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
   <span class="comment">|</span> <span class="comment">MN</span>  <span class="comment">|</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">move</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt; <span class="comment">|</span> <span class="comment">MN</span>  <span class="comment">|</span>
   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>                          <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>


              <span class="comment">Figure</span> <span class="comment">2:The</span> <span class="comment">transmission</span> <span class="comment">of</span> <span class="comment">data</span> <span class="comment">packets
</pre></figure></code></pre>
<h2>6.  Message Formats</h2>
<p>略</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-05-06T02:45:00.000Z"><a href="/2013/05/06/draft-luo-dmm-with-ipv6-prefix-properties-00/">5月 6 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/05/06/draft-luo-dmm-with-ipv6-prefix-properties-00/">draft-luo-dmm-with-ipv6-prefix-properties-00</a></h1>
  

    </header>
    <div class="entry">
      
        <h1>Distributed Mobility Management Approaches with IPv6 Prefix Properties</h1>
<h3><a href="http://tools.ietf.org/html/draft-luo-dmm-with-ipv6-prefix-properties-00">draft-luo-dmm-with-ipv6-prefix-properties-00</a></h3>
<p>为了支持一个更分布的模型，本文扩展了现有的基于PMIP的移动性管理协议，并通过引入两个新的逻辑功能来实现分布式锚定和定位管理。鉴于MN可能并不总是需要移动性支持，即需要应用全局性前缀和其他的网络资源，本草案支持该选项以此来补充IPv6前缀源地址选择提示（即IPv6邻居发现协议和它的前缀信息选项）的扩展属性，实现了UE可以根据其服务/应用的移动性支持需求来选择IPv6的前缀。当MN支持扩展的前缀属性功能时，该草案允许ＭＮ可以根据 I-D.korhonen-dmm-prefix-properties 里描述的机制来选择合适的前缀。一旦确定了IPv6前缀，其余的ＤＭＭ机制则与I-D.luo-dmm-pmip-based-dmm-approach 类似。</p>
<hr>
<h2>Solution Overview</h2>
<p>两个新的逻辑功能:</p>
<ul>
<li>位置管理功能（LMF）， 用来维护IP地址与MN位置之间的匹配</li>
<li>分布式定位功能（DAF）用来对MN的第一跳路由器提供本地定位支持，并在 I-D.luo-dmm-pmip-based-dmm-approach 第七部分中进行了描述，被称为增强型的LMA（eLMA）并且与在 RFC5213 中描述的LMA具有相似的性质。</li>
</ul>
<p>DAF由分布式路由子功能（DRF）和分布式移动子功能（DMF）组成：</p>
<ul>
<li>DRF在MN的第一跳路由器上作为分布式隧道端点进行操作，以此来支持在两个DMM端点（例如MN与其相应的节点，如CN）之间的优化的路由。</li>
<li>DMF用来支持移动节点的移动性切换操作，减少在优化的路由建立的过程中数据包的丢失。</li>
</ul>
<p>在初始的MN附着中，本方案通过重新使用一个选项，即利用korhonen方案<a href="http://tools.ietf.org/html/draft-korhonen-dmm-prefix-properties-02">I-D.korhonen-dmm-prefix-properties</a>向MN传达IPv6前缀的源地址选择提示（例如在本草案中定义的前缀信息选项‘M’标志）。</p>
<pre><code><figure class="highlight"><pre>     <span class="comment">Internet</span>
        <span class="comment">|</span>           <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
        <span class="comment">|</span>           <span class="comment">|</span> <span class="comment">LMF</span> <span class="comment">|</span>
  <span class="comment">Border</span> <span class="comment">Router</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
        <span class="comment">|</span>
        <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>
                          <span class="comment">|</span>
                      <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
                      <span class="comment">|</span> <span class="comment">eLMA1</span> <span class="comment">|</span>
                      <span class="comment">|</span> <span class="comment">(DAF)</span> <span class="comment">|</span>
                      <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
           <span class="comment">Global</span> <span class="comment">Prefix</span> <span class="comment">|</span>  <span class="comment">|Local</span> <span class="comment">Prefix</span>
               <span class="comment">(PreB)</span>    <span class="comment">|</span>  <span class="comment">|</span>  <span class="comment">(PreA)</span>
                         <span class="comment">V</span>  <span class="comment">V</span>
                        <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
                        <span class="comment">|</span> <span class="comment">MN</span> <span class="comment">|</span>
                        <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
        <span class="comment">IP1:</span> <span class="comment">From</span> <span class="comment">PreA</span> <span class="comment">(Local</span>, <span class="comment">without</span> <span class="comment">mobility)</span>
        <span class="comment">IP2:</span> <span class="comment">From</span> <span class="comment">PreB</span> <span class="comment">(Global</span>, <span class="comment">with</span> <span class="comment">mobility)</span>

              <span class="comment">Figure</span> <span class="comment">1</span>.  <span class="comment">Initial</span> <span class="comment">Attach
</pre></figure></code></pre>
<p>当eLMA检测到一个初始的MN附件时，它会像该MN发出一个RA消息。该RA包括IPv6前缀，每个前缀都被它的属性进行标记，包括它的移动管理属性。根据移动管理属性，IPv6前缀被MN区分为两类，即全局前缀和本地前缀。它们被定义如下:</p>
<ul>
<li>全局前缀：如果一个来自全局前缀的IPv6地址被用作一个会话的源地址，那么将通过使用本草案中规定的移动性管理机制来向该会话提供完全的移动性支持。这意味着即使连接点改变了，地址始终保持有效。</li>
<li>本地前缀：如果一个来自本地前缀的IPv6地址被用作一个会话的源地址，不向该会话提供或者只提供有一定限制的移动性支持。那么当连接点改变的时候，地址可能不是有效的。</li>
</ul>
<p>根据已获取的移动性管理性质，MN根据IPv6前缀的两种分类来支持它的服务应用。如果MN的应用需要移动性支持，MN将通过让应用调用一个适当的API套接字扩展来从全局前缀中获取一个IPv6地址。反之，如果MN的应用不需要或者只要求有限的移动性支持，MN将通过调用另一个适当的API套接字扩展来从本地前缀中获取一个IPv6地址。</p>
<p>网络不会向本地IPv6前缀提供移动性，这意味着当MN改变它的连接点时（如eLMA)，那么前一个eLMA分配的本地前缀将被弃用\无效。当连接到下一个eLMA时，新的eLMA会分配一个新的本地前缀。</p>
<p>eLMA只为那些全局前缀向LMF更新位置信息。</p>
<h2>Detailed Scenarios and Approaches</h2>
<h4>Initial Attach</h4>
<p>当eLMA1检测到一个移动节点的最初链接，它向该移动节点发送一条RA消息。该RA包含两种前缀：本地前缀（PreA）和全局前缀（PreB）。eLMA应该根据[I-D.korhonen-dmm-prefix-properties]给PreA(如本地前缀)(<a href="http://tools.ietf.org/html/draft-korhonen-dmm-prefix-properties-02)分配一个高优先级，同时给PreB(如全局前缀)分配一个低优先级。">http://tools.ietf.org/html/draft-korhonen-dmm-prefix-properties-02)分配一个高优先级，同时给PreB(如全局前缀)分配一个低优先级。</a></p>
<p>移动节点的应用可以选择一个合适的IPv6地址作为它的源地址，如<a href="http://tools.ietf.org/html/draft-korhonen-dmm-prefix-properties-02">I-D.korhonen-dmm-prefix-properties</a>中第4节描述的。</p>
<h4>Data forwarding</h4>
<pre><code><figure class="highlight"><pre>                                <span class="comment">IP1</span> <span class="comment">as</span> <span class="comment">destination:</span>
                                <span class="comment">common</span> <span class="comment">routing</span>
                          <span class="comment">|</span>             <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>       <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
                          <span class="comment">|</span>             <span class="comment">|</span> <span class="comment">eLMA3</span> <span class="comment">|_______|</span> <span class="comment">CN</span> <span class="comment">|</span>
       <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>            <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span> <span class="comment">(DAF)</span> <span class="comment">|</span>       <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
       <span class="comment">|</span> <span class="comment">LMF</span> <span class="comment">|</span>            <span class="comment">|</span>             <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
       <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>            <span class="comment">|</span>     <span class="comment">IP2</span> <span class="comment">as</span> <span class="comment">destination:</span>
                          <span class="comment">|</span>     <span class="comment">Routing</span> <span class="comment">based</span> <span class="comment">on</span> <span class="comment">location</span>
       <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="comment">(e</span>.<span class="comment">g</span>. <span class="comment">IP</span> <span class="comment">in</span> <span class="comment">IP</span> <span class="comment">tunnel)</span>
                     <span class="comment">|</span>
                 <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
                 <span class="comment">|</span> <span class="comment">eLMA1</span> <span class="comment">|</span>
                 <span class="comment">|</span> <span class="comment">(DAF)</span> <span class="comment">|</span>
                 <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
      <span class="comment">Global</span> <span class="comment">Prefix</span> <span class="comment">|</span>  <span class="comment">|Local</span> <span class="comment">Prefix</span>
          <span class="comment">(PreB)</span>    <span class="comment">|</span>  <span class="comment">|</span>  <span class="comment">(PreA)</span>
                    <span class="comment">V</span>  <span class="comment">V</span>
                   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
                   <span class="comment">|</span> <span class="comment">MN</span> <span class="comment">|</span>
                   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
   <span class="comment">IP1:</span> <span class="comment">From</span> <span class="comment">PreA</span> <span class="comment">(Local</span>, <span class="comment">without</span> <span class="comment">mobility)</span>
   <span class="comment">IP2:</span> <span class="comment">From</span> <span class="comment">PreB</span> <span class="comment">(Global</span>, <span class="comment">with</span> <span class="comment">mobility)</span>

        <span class="comment">Figure</span> <span class="comment">2</span>.<span class="comment">1</span> <span class="comment">Data</span> <span class="comment">forwarding</span> <span class="comment">mechanism
</pre></figure></code></pre>
<p>当通信节点（CN）向MN发送消息时，首先到达CN的eLMA3。eLMA3将根据目的IPv6地址的类别进行操作：</p>
<ol>
<li>如果目的IPv6包含本地IPv6前缀（图2.1中的IP1），eLMA3将使用通用的路由机制来发送IP包。</li>
<li>如果目的IPv6地址包含全局IPv6前缀（图2.1中的IP2），那么eLMA3将使用<a href="http://tools.ietf.org/id/draft-luo-dmm-pmip-based-dmm-approach-01.txt">I-D.luo-dmm-pmip-based-dmm-approach</a>7.2节中描述的路由机制来发送IP包。</li>
</ol>
<h4>Handoff Scenario</h4>
<pre><code><figure class="highlight"><pre>                                          <span class="comment">IP1</span> <span class="comment">as</span> <span class="comment">destination:</span>
                                          <span class="comment">can</span> <span class="comment">not</span> <span class="comment">be</span> <span class="comment">reachable</span>
                                          <span class="comment">after</span> <span class="comment">handoff</span>
    <span class="comment">Internet</span>                              <span class="comment">IP3</span> <span class="comment">as</span> <span class="comment">destination:</span>
        <span class="comment">|</span>                                 <span class="comment">common</span> <span class="comment">routing</span>
        <span class="comment">|</span>                                     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>       <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
        <span class="comment">|</span>                              <span class="comment">|</span>      <span class="comment">|</span> <span class="comment">eLMA3</span> <span class="comment">|_______|</span> <span class="comment">CN</span> <span class="comment">|</span>
        <span class="comment">|</span>          <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>             <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span> <span class="comment">(DAF)</span> <span class="comment">|</span>       <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
  <span class="comment">Border</span> <span class="comment">Router</span>    <span class="comment">|</span> <span class="comment">LMF</span> <span class="comment">|</span>             <span class="comment">|</span>      <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
        <span class="comment">|</span>          <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>             <span class="comment">|</span>  <span class="comment">IP2</span> <span class="comment">as</span> <span class="comment">destination:</span>
        <span class="comment">|</span>                              <span class="comment">|</span>  <span class="comment">Routing</span> <span class="comment">based</span> <span class="comment">on</span> <span class="comment">location</span>
        <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
              <span class="comment">|</span>                     <span class="comment">|</span>
          <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>             <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
          <span class="comment">|</span> <span class="comment">eLMA2</span> <span class="comment">|</span>             <span class="comment">|</span> <span class="comment">eLMA1</span> <span class="comment">|</span>
          <span class="comment">|</span> <span class="comment">(DAF)</span> <span class="comment">|</span>             <span class="comment">|</span> <span class="comment">(DAF)</span> <span class="comment">|</span>
          <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>             <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
<span class="comment">Local</span> <span class="comment">Prefix</span> <span class="comment">|</span>  <span class="comment">|</span>   <span class="comment">Global</span> <span class="comment">Prefix</span>   <span class="comment">|</span>  <span class="comment">|Local</span> <span class="comment">Prefix</span>
  <span class="comment">(PreC)</span>     <span class="comment">|</span>  <span class="comment">|</span>       <span class="comment">(PreB)</span>      <span class="comment">|</span>  <span class="comment">|</span>  <span class="comment">(PreA)</span>
             <span class="comment">V</span>  <span class="comment">V</span>                   <span class="comment">V</span>  <span class="comment">V</span>
            <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>                 <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
            <span class="comment">|</span> <span class="comment">MN</span> <span class="comment">|</span>   &lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span> <span class="comment">|</span> <span class="comment">MN</span> <span class="comment">|</span>
            <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>                 <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
 <span class="comment">IP3:</span> <span class="comment">From</span> <span class="comment">PreC</span>                <span class="comment">IP1:</span> <span class="comment">From</span> <span class="comment">PreA</span>
 <span class="comment">(Local</span>, <span class="comment">without</span> <span class="comment">mobility)</span>     <span class="comment">(Local</span>, <span class="comment">without</span> <span class="comment">mobility)</span>
 <span class="comment">IP2:Keep</span> <span class="comment">unchanged</span>            <span class="comment">IP2:</span> <span class="comment">From</span> <span class="comment">PreB</span>
 <span class="comment">(Global</span>, <span class="comment">with</span> <span class="comment">mobility)</span>       <span class="comment">(Global</span>, <span class="comment">with</span> <span class="comment">mobility)</span>

   <span class="comment">Figure</span> <span class="comment">3</span>.<span class="comment">1</span> <span class="comment">Handover</span> <span class="comment">Scenario
</pre></figure></code></pre>
<p>从CN发送到IP1（从PreA中配置的）的通信将被IPv6路由系统自动丢弃；除非在前一个和下一个分布式定位之间建立一条临时的隧道用来维护到前一个本地前缀的可达性。依赖这些本地前缀的应用可能会遇到源IP地址变化的情况。</p>
<p>由eLMA2分配的RA消息携带的新的本地前缀（如图3.1中的PreC）目前有高优先级。MN将为PreC生成一个新的IPv6本地地址（图3.1中IP3）。</p>
<p>MN初始连接过程中eLMA1分配的全局前缀在RA消息中保持不变。为了维护这些全局地址的可达性，eLMA2应该向LMF执行位置更新，来维持全局前缀的可达性。<a href="http://tools.ietf.org/id/draft-luo-dmm-pmip-based-dmm-approach-01.txt">I-D.luo-dmm-pmip-based-dmm-approach</a>中的7.2节对切换细节进行了详细的描述。</p>
<p>因此，执行切换之后，既可以通过新的本地IPv6地址（如IP3）也可以通过全局IPv6地址（如IP2）来到达移动节点；如果在eLMA1和eLMA2之间有临时通道，也可以通过前一个本地IPv6地址（如IP1）到达。</p>
<p>是否在eLMA1与eLMA2之间建立临时隧道来维持本地前缀的可达，这取决于网络策略。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-05-06T02:40:00.000Z"><a href="/2013/05/06/draft-liu-dmm-dynamic-anchor-discussion-00/">5月 6 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/05/06/draft-liu-dmm-dynamic-anchor-discussion-00/">draft-liu-dmm-dynamic-anchor-discussion-00</a></h1>
  

    </header>
    <div class="entry">
      
        <h1>DMM Dynamic Anchor Discussion</h1>
<p><em>给MN配置多个地址</em></p>
<h3><a href="http://tools.ietf.org/html/draft-liu-dmm-dynamic-anchor-discussion-00">draft-liu-dmm-dynamic-anchor-discussion-00</a></h3>
<p>There are many different proposals for DMM solution, one of those types of solution is called &quot;dynamic anchor&quot;. This document analyses the limitations of current dynamic anchor solution and discusses the possible solution to overcome those limitations.</p>
<h2>Problem of dynamic anchor and potential solution</h2>
<blockquote>
<p>draft-seite-dmm-dma-00</p>
</blockquote>
<ol>
<li><p>The main idea of dynamic anchor is <strong>distributing the mobility anchor function in the access router (MAR)</strong>. </p>
</li>
<li><p><strong>The newly initiated session is routed through the current MAR</strong>, only the <strong>original sessions that established before handover will be maintained at the previous anchor</strong>.</p>
</li>
<li>picture</li>
</ol>
<h3>Active session managment</h3>
<blockquote>
<p>Problem: how MAR2 know that there is an active session for HNP1 in MN?</p>
<blockquote>
<p>policy server to store</p>
</blockquote>
<p>MAR2/MAR1 has to have some mechanism to trigger the release HNP1</p>
<blockquote>
<p>Otherwise MAR1 will always be occupied by the MN, this leads system capacity waste</p>
<p>One of possible solution is that MAR2 can inspect the traffic that has the source address prefix equals to HNP1.</p>
<p>Need many Timers on MAR2, which leads system capacity consumed</p>
</blockquote>
</blockquote>
<h3>Soure address selection</h3>
<blockquote>
<p>RFC3484 specifies the source address selection rules for IPv6 but RFC3484 is not enough to cope with this situation since RFC3284 does not specify how to select source address for a particular application.</p>
</blockquote>
<p><strong>Solution</strong> </p>
<blockquote>
<p>For any on-going session, keep to use the original address even there is a newly address been configured for the same interface.</p>
<p>For any new session, always choose to use the newly allocated address. The new MAR need to advertise the newly allocated prefix as the highest priority.</p>
</blockquote>
<h3>CN address selection</h3>
<p>From the CN’s perspective, the MN has multiple addresses, the CN needs to know which one it should use when it wants to initiate a session to MN.</p>
<h3>IPv4 support</h3>
<p>It will worse the IPv4 address depletion problem if use the dynamic anchor solution for IPv4 since each MN will need multiple IP addresses in that case.</p>
<h3>Resource consumption consideration</h3>
<ul>
<li><p>MN在多个MAR间频繁切换，消耗网络资源</p>
</li>
<li><p>同时还有被hacker利用，消耗网络资源的危险</p>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2013-05-06T02:35:00.000Z"><a href="/2013/05/06/draft-liu-dmm-address-selection-01/">5月 6 2013</a></time>
      
      
  
    <h1 class="title"><a href="/2013/05/06/draft-liu-dmm-address-selection-01/">draft-liu-dmm-address-selection-01</a></h1>
  

    </header>
    <div class="entry">
      
        <h1>Address Selection for DMM</h1>
<h3><a href="http://tools.ietf.org/html/draft-liu-dmm-address-selection-01">draft-liu-dmm-address-selection-01</a></h3>
<pre><code><figure class="highlight"><pre>移动节点有可能有多个移动锚点以及相对应的前缀。
在这种情况下，移动节点需要知道地址类型以选择一个正确的地址供应用使用。
本篇文档描述了一种扩展路由通告消息的机制，通过携带一个标志以用来鉴别前缀的性质。
</pre></figure></code></pre>
<hr>
<h2>Problem of address selection for DMM</h2>
<blockquote>
<p>draft-liu-dmm-dynamic-anchor-discussion-00</p>
</blockquote>
<p>分布式移动管理动态节点方案有地址选择的问题。这个问题的难点在于：移动节点并不知道多个前缀之间的区别。网络无法告知移动节点不同前缀性质之间的区别，而且也没有标准的机制让移动节点选择正确的前缀。</p>
<h2>Extension to Router Advertisment</h2>
<p>   移动IPv6 <a href="http://www.ietf.org/rfc/rfc3775.txt">RFC3775</a> 扩展了IPv6路由通告消息用来移动探测和本地代理信息广播。这篇文档建议对IPv6路由通告消息进行更多扩展以携带一个标志对它通告的前缀性质进行鉴别。<strong>H位</strong>被用来标识路由通告是由本地代理发送的。</p>
<pre><code><figure class="highlight"><pre>                  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
                  <span class="comment">|</span>  <span class="comment">Type</span>    <span class="comment">|</span>  <span class="comment">Code</span>   <span class="comment">|</span>     <span class="comment">Checksum</span>      <span class="comment">|</span>
                  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
                  <span class="comment">|Hop</span> <span class="comment">Limit</span> <span class="comment">|M|O|H|Re</span>-<span class="comment">|</span>    <span class="comment">Router</span> <span class="comment">Lifetime|</span>
                  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
                  <span class="comment">|</span>          <span class="comment">Reachable</span> <span class="comment">Time</span>                <span class="comment">|</span>
                  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
                  <span class="comment">|</span>          <span class="comment">Retrans</span> <span class="comment">Timer</span>                 <span class="comment">|</span>
                  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
                  <span class="comment">|</span>          <span class="comment">Options</span>                       <span class="comment">|</span>
                  <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
</pre></figure></code></pre>
<p>扩展前缀消息选项，添加一个“T”标志，其定义如下：</p>
<h4>T类型标志</h4>
<ul>
<li>00: 本地网络前缀。它表明这个前缀是由该移动节点所属的路由器分配和通告的。</li>
<li>01: 远程网络前缀。它表明这个前缀是除这个移动节点所属的路由外的其他路由分配的。</li>
<li>10: 保留</li>
<li><p>11: 保留</p>
<pre><code><figure class="highlight"><pre>          <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
          <span class="comment">|</span>    <span class="comment">Type</span>     <span class="comment">|</span>    <span class="comment">Length</span>  <span class="comment">|PrefixLength|L|A|R|T</span> <span class="comment">|R</span>- <span class="comment">|</span>
          <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
          <span class="comment">|</span>                 <span class="comment">Valid</span> <span class="comment">Lifetime</span>                     <span class="comment">|</span>
          <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
          <span class="comment">|</span>                 <span class="comment">Preferred</span> <span class="comment">Lifetime</span>                 <span class="comment">|</span>
          <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
          <span class="comment">|</span>                 <span class="comment">Reserved</span>                           <span class="comment">|</span>
          <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
          <span class="comment">|</span>                                                    <span class="comment">|</span>
          <span class="comment">|</span>                 <span class="comment">Prefix</span>                             <span class="comment">|</span>
          <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
</pre></figure></code></pre>
</li>
</ul>
<p><strong>路由用来鉴别前缀类型的机制在这篇文档的范围之外。比如说，路由能通过查询策略服务器来知道由哪个路由分配特定的前缀。</strong></p>
<h2>Mobile Node Operation</h2>
<p>移动节点通过路由通告消息的T标志识别前缀类型。移动节点上的应用可以通过这个信息来选择正确的IP地址。比如说，在一个在会话中，应用一直选择之前使用的前缀直至其被移交到新的位置。对于新初始的应用，他会使用被当前路由分配的前缀。</p>
<h4>An Example of How This Draft Works</h4>
<pre><code><figure class="highlight"><pre>     <span class="comment">_______</span>     <span class="comment">_______</span>    <span class="comment">_______</span>
    <span class="comment">|</span>       <span class="comment">|</span>   <span class="comment">|</span>       <span class="comment">|</span>  <span class="comment">|</span>       <span class="comment">|</span>
    <span class="comment">|</span>  <span class="comment">CN1</span>  <span class="comment">|</span>   <span class="comment">|</span>  <span class="comment">CN2</span>  <span class="comment">|</span>  <span class="comment">|</span>  <span class="comment">CN3</span>  <span class="comment">|</span>
    <span class="comment">|_______|</span>   <span class="comment">|_______|</span>  <span class="comment">|_______|</span>
        <span class="comment">'</span>           <span class="string">.</span>            <span class="string">.</span>
 <span class="comment">Flow#1</span> <span class="comment">'</span>    <span class="comment">Flow#2</span> <span class="string">.</span>            <span class="comment">|</span>  <span class="comment">Flow#3</span>
        <span class="comment">'</span>   <span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="comment">'''''</span>.<span class="comment">'''''''</span>.<span class="string">.</span><span class="string">.</span><span class="string">.</span> <span class="string">.</span>
      <span class="string">.</span><span class="string">.</span><span class="comment">'''</span>         <span class="string">.</span>           <span class="comment">'''</span>.<span class="string">.</span>
    <span class="string">.</span><span class="comment">'</span>  <span class="comment">'</span>      <span class="comment">IP</span> <span class="comment">network</span>        <span class="string">.</span>   <span class="comment">'</span>.
    <span class="comment">:</span>   <span class="comment">'</span>           <span class="string">.</span>            <span class="comment">|</span>    <span class="comment">:</span>
     <span class="comment">'</span>.<span class="string">.</span><span class="comment">'</span>       <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>        <span class="string">.</span> <span class="string">.</span><span class="string">.</span><span class="comment">'</span>
        <span class="comment">'''</span>.<span class="string">.</span><span class="string">.</span>  <span class="comment">|</span>       <span class="comment">|</span>.<span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="comment">'''</span>
        <span class="comment">'</span>       <span class="comment">|</span> <span class="comment">MAR2</span>  <span class="comment">|</span> <span class="comment">\</span>      <span class="string">.</span>
        <span class="comment">'</span>       <span class="comment">|</span>       <span class="comment">|</span>. <span class="comment">\</span>     <span class="comment">|</span>
        <span class="comment">'</span>       <span class="comment">|</span>       <span class="comment">|</span> <span class="string">.</span> <span class="comment">\</span>    <span class="string">.</span>
        <span class="comment">'</span>       <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span><span class="comment">\</span>  <span class="string">.</span><span class="comment">\</span>   <span class="comment">|</span>
   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>   <span class="comment">HNP2(T=00)</span> <span class="comment">\</span>  <span class="literal">+</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
   <span class="comment">|</span>       <span class="comment">|</span>   <span class="comment">HNP1(T=01)</span>  <span class="comment">\</span> <span class="comment">|</span>       <span class="comment">|</span> <span class="comment">HNP3(T=00)</span>
   <span class="comment">|</span> <span class="comment">MAR1</span>  <span class="comment">|</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">|</span>  <span class="comment">MAR3</span> <span class="comment">|</span> <span class="comment">HNP2(T=01)</span>
   <span class="comment">|</span>       <span class="comment">|</span> <span class="comment">''''''''''''''''|</span>       <span class="comment">|</span> <span class="comment">HNP1(T=01)</span>
   <span class="comment">|</span>       <span class="comment">|</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">|</span>       <span class="comment">|</span>
   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>                 <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
   <span class="comment">HNP1(T=00)</span>                   <span class="comment">'</span> <span class="string">.</span> <span class="comment">|</span>
                        <span class="comment">Flow#1</span>  <span class="comment">'</span> <span class="string">.</span> <span class="string">.</span>  <span class="comment">Flow#3</span>
                                <span class="comment">'</span> <span class="string">.</span> <span class="comment">|</span>
     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>            <span class="comment">Flow#2</span> <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
     <span class="comment">|</span> <span class="comment">MN</span>  <span class="comment">|</span> <span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">move</span>-<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>&gt; <span class="comment">|</span> <span class="comment">MN</span>  <span class="comment">|</span>
     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>                   <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
</pre></figure></code></pre>
<ol>
<li>当移动节点附属到MAR1，MAR1发送了路由通告消息，包含前缀信息选项的移动节点的HNP1以及T标志位设置为00。这表明HNP1是由当前路由（MAR1）分配和通告的本地网络前缀。移动节点能通过取自HNP1的IPv6地址初始化与CN1的会话（如图中的flow#1）。</li>
<li>当移动节点切换至MAR2（flow#1在移动节点切换时仍在持续），MAR2发送包含了移动节点的HNP2的路由通告消息，其类型标志T被设置成00，同时之前的前缀（HNP1）被设置成01。移动节点就会识别HNP2是当前本地网络前缀，而HNP1是远程网络前缀。这时，移动节点会用取自HNP2的IPv6地址作为源地址初始化一个新的与CN2（如图中的flow#2）会话。因为IPv6地址取自本地网络前缀（HNP2），flow#2会使用常规的IPv6协议。对于flow#1，MAR1充当LMA，MAR2充当MAG。</li>
<li>当移动节点切换至MAR3时（移动节点切换时flow#1和flow#2仍在持续），MAR3发送包含了移动节点新的前缀（HNP3）的路由通告消息，类型标志（T）被置为00，而之前的前缀（HNP1、HNP2）的类型标志（T）被置为01。这表明HNP3是本地网络前缀，而HNP1和HNP2是远程网络前缀。这时，移动节点把从HNP3取得的IPv6地址作为原地址，初始化与CN3的会话（比如图中的flow#3）。flow#3使用常规的IPv6协议。</li>
</ol>
<h4>MN Handoffs From MAR Back to Its Previous MAR</h4>
<p>上述过程的逆过程。略。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  

  <nav id="pagination">
  
  
    <a href="/archives/2013/page/2/" class="alignright next">下一页</a>
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:fedoral.github.io/">
  </form>
</div>

  

  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/DMM/">DMM</a><small>9</small></li>
  
    <li><a href="/tags/hadoop/">hadoop</a><small>1</small></li>
  
  </ul>
</div>


  

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2013 Peng Feixiang
  
</div>
<div class="clearfix"></div></footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>